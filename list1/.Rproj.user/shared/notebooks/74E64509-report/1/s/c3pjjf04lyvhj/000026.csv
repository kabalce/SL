"0","FWER <- function(true_values, test_results) { "
"0","  # T - reject H0, F - accept H0"
"0","  as.integer(any(test_results[which(!true_values)]))"
"0","}"
"0",""
"0","FDR <- function(true_values, test_results) {"
"0","  sum(test_results[which(!true_values)]) / max(sum(test_results), 1)"
"0","}"
"0",""
"0","power <- function(true_values, test_results) {"
"0","  mean(test_results[which(true_values)])"
"0","}"
"0",""
"0","sim_step <- function(i, X, Y) {"
"0","  model <- lm(Y~X[, 1:i] - 1)"
"0","  msum <- summary(model)"
"0","  # a"
"0","  sd_val <- msum$coefficients[, 2]"
"0","  # separatly"
"0","  # b"
"0","  CI_len <- abs(confint(model, level=0.9)[, 1] - confint(model, level=0.9)[, 2])"
"0","  # c"
"0","  pvals <- msum$coefficients[, 4]"
"0","  res_i <- pvals <= alpha"
"0","  res_ii <- bonferroni(pvals, alpha)"
"0","  res_iii <- benjamini_hochberg(pvals, alpha)"
"0","  true_vals <- beta_vec[1:i] > 0"
"0","  "
"0","  FWER_i <- FWER(true_vals, res_i)"
"0","  FDR_i <- FDR(true_vals, res_i)"
"0","  power_i <- power(true_vals, res_i)"
"0","  "
"0","  FWER_ii <- FWER(true_vals, res_ii)"
"0","  FDR_ii <- FDR(true_vals, res_ii)"
"0","  power_ii <- power(true_vals, res_ii)"
"0","  "
"0","  FWER_iii <- FWER(true_vals, res_iii)"
"0","  FDR_iii <- FDR(true_vals, res_iii)"
"0","  power_iii <- power(true_vals, res_iii)"
"0","  "
"0","  return(list(sd = sd_val, CI = CI_len, "
"0","              FWER_st = FWER_i, FDR_st = FDR_i, power_st = power_i,"
"0","              FWER_bonf = FWER_ii, FDR_bonf = FDR_ii, power_bonf = power_ii,"
"0","              FWER_bh = FWER_iii, FDR_bh = FDR_iii, power_bh = power_iii))"
"0","}"
"0",""
"0","i_vec <- c(10, 100, 500, 950)"
"0",""
"0","simulation <- function() {"
"0","  X <- matrix(rnorm(1000 * 950, 0, sqrt(1/1000)), nrow=1000)"
"0","  Y <- X %*% beta_vec + rnorm(1000, 0, 1)"
"0","  sapply(i_vec, function(i) sim_step(i, X, Y))"
"0","}"
"0",""
"0","# results <- replicate(10, simulation())"
"0",""
"0","tab <- data.frame()"
"0",""
"0","for (i in 1:length(i_vec)) {"
"0","  sd_means <- rowMeans(simplify2array(results[1, i, ]))"
"0","  "
"0","  print(ggplot() + "
"0","    geom_histogram(aes(x=sd_means)) + "
"0","    ggtitle(str_c(""Standard Deviation Histogram for i = "",  "
"0","                       as.character(i_vec[i]))) )  #%>% "
"0","    # print()"
"0","    "
"0","  CI_means <- rowMeans(simplify2array(results[2, i, ]))"
"0","  "
"0","  ggplot() +"
"0","    geom_histogram(aes(x=CI_means))+ "
"0","    ggtitle(str_c(""Confidence Interval Length Histogram for i = "",  "
"0","                       as.character(i_vec[i])))  #%>% "
"0","    # show()"
"0","  "
"0","  FWERv <- mean(simplify2array(results[3,  i, ]))"
"0","  FDRv <- mean(simplify2array(results[4,  i, ]))"
"0","  powerv <- mean(simplify2array(results[5,  i, ]))"
"0","  FWERb <- mean(simplify2array(results[6,  i, ]))"
"0","  FDRb <- mean(simplify2array(results[7,  i, ]))"
"0","  powerb <- mean(simplify2array(results[8,  i, ]))"
"0","  FWERbh <- mean(simplify2array(results[9,  i, ]))"
"0","  FDRbh <- mean(simplify2array(results[10,  i, ]))"
"0","  powerbh <- mean(simplify2array(results[11,  i, ]))"
"0","  "
"0","  tab <- rbind(tab, c(i_vec[i], mean(sd_means), mean(CI_means), FWERv, FDRv, powerv,"
"0","                      FWERb, FDRb, powerb,  FWERbh, FDRbh, powerbh))"
"0","  "
"0","}"
